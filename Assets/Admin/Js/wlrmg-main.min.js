/**
 * @author      Wployalty (Ilaiyaraja)
 * @license     http://www.gnu.org/licenses/gpl-2.0.html
 * @link        https://www.wployalty.net
 * */ "undefined"==typeof wlrmg_jquery&&(wlrmg_jquery=jQuery.noConflict()),wlrmg=window.wlrmg||{},wlrmg_jquery(document).ready(function(){wlrmg_jquery("#wlrmg-main-page .wlrmg-multi-select").select2()}),wlrmg,alertify.set("notifier","position","top-right"),wlrmg.searchActivityByEmail=function(a){let t=wlrmg_jquery("#wlrmg-main-page #wlrmg-activity-details #search_email").val();""!==t&&(a=a+"&search="+t),window.location.href=a+"#wlrmg-activity-list-table"},wlrmg.saveSettings=function(){var a=wlrmg_jquery("#wlrmg-main-page #wlrmg-settings #wlrmg-save-settings");if("disabled"===a.attr("disabled"))return;a.attr("disabled",!0),wlrmg_jquery("#wlrmg-main-page #wlrmg-settings #wlrmg-save-settings").css({cursor:"not-allowed",opacity:"0.4"});let t=wlrmg_jquery("#wlrmg-main-page #wlrmg-settings #settings-form").serialize();wlrmg_jquery.ajax({url:wlrmg_localize_data.ajax_url,type:"POST",dataType:"json",data:t+"&action=wlrmg_save_settings&wlrmg_nonce="+wlrmg_localize_data.save_settings,cache:!1,success:function(t){t.success?alertify.success(t.data.message):alertify.error(t.data.message),a.removeAttr("onclick"),a.attr("disabled",!1).attr("onclick","wlrmg.saveSettings()"),wlrmg_jquery("#wlrmg-main-page #wlrmg-settings #wlrmg-save-settings").css({cursor:"pointer",opacity:"1"})}})},wlrmg.needConfirmPointUpdate=function(a){wlrmg_jquery.ajax({url:wlrmg_localize_data.ajax_url,type:"POST",dataType:"json",data:{action:"wlrmg_confirm_update_points",category:a,wlrmg_nonce:wlrmg_localize_data.migrate_users},cache:!1,async:!1,success:function(a){!0===a.status&&(wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section").addClass("active"),wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section .wlrmg-overlay").html(a.data.html),console.log(wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section #update_point.wlrmg-multi-select")),wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section #update_point.wlrmg-multi-select").select2())}})},wlrmg.migrateUsers=function(){let a=wlrmg_jquery("#wlrmg-popup #migration_type").val(),t=wlrmg_jquery("#wlrmg-popup #update_point").val();wlrmg_jquery.ajax({url:wlrmg_localize_data.ajax_url,type:"POST",dataType:"json",data:{action:"wlrmg_migrate_users",wlrmg_nonce:wlrmg_localize_data.migrate_users,migration_action:a,update_point:t},cache:!1,async:!1,success:function(a){a.success?(alertify.success(a.data.message),setTimeout(function(){window.location.reload()},1e3)):alertify.error(a.data.message)}})},wlrmg.redirectToUrl=function(a){window.location.href=a},wlrmg.exportPopUp=function(a,t){wlrmg_jquery.ajax({url:wlrmg_localize_data.ajax_url,type:"POST",dataType:"JSON",data:{wlrmg_nonce:wlrmg_localize_data.popup_nonce,action:"wlrmg_export_popup",migration_action:t,job_id:a},success:function(a){a.success&&(wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section").addClass("active"),wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section .wlrmg-overlay").html(a.data.html))}})},wlrmg.startExport=function(){var a=wlrmg_jquery("#wlrmg-export-preview").serializeArray();wlrmg_jquery("#wlrmg-process-export-button").attr("disabled",!0),wlrmg_jquery("#wlrmg-overlay-section .wlrmg-export-popup .wlrf-close-circle").css("display","none"),wlrmg_jquery.ajax({url:wlrmg_localize_data.ajax_url,type:"post",data:a,dataType:"json",cache:!1}).done(function(a){if("completed"!=a.data.success){wlrmg_jquery("#wlrmg_limit_start").val(a.data.limit_start),wlrmg_jquery("#wlrmg-notification").css("display","flex"),wlrmg_jquery("#wlrmg-notification").html("<div class='alert success'>"+a.data.notification+"</div>");var t=wlrmg_jquery("#wlrmg-total-count").val();t<a.data.limit_start?wlrmg_jquery("#wlrmg-process-count").html(t):wlrmg_jquery("#wlrmg-process-count").html(a.data.limit_start),wlrmg.startExport()}else"completed"==a.data.success&&(wlrmg_jquery("#wlrmg-overlay-section .wlrmg-export-popup .wlrf-close-circle").css("display","block"),wlrmg_jquery("#wlrmg-notification").append("<div class='alert success'> "+a.data.notification+"</div>"),setTimeout(function(){alertify.alert().close(),location.reload()},1500))})},wlrmg.showExported=function(a,t){wlrmg_jquery.ajax({url:wlrmg_localize_data.ajax_url,type:"POST",dataType:"JSON",data:{wlrmg_nonce:wlrmg_localize_data.popup_nonce,action:"wlrmg_get_exported_list",action_type:t,job_id:a},success:function(a){a.success&&(wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section").addClass("active"),wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section .wlrmg-overlay").html(a.data.html))}})},wlrmg.closePopUp=function(a){wlrmg_jquery("#wlrmg-main-page #wlrmg-overlay-section").removeClass("active"),a&&window.location.reload()};